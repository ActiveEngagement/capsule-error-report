(("undefined"!==typeof self?self:this)["webpackJsonpCapsuleErrorReport"]=("undefined"!==typeof self?self:this)["webpackJsonpCapsuleErrorReport"]||[]).push([[8],{"03bf":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("capsule-editor",{ref:"editor",attrs:{"demo-mode":"",errors:t.lint.errors,filename:t.lint.filename,"api-key":t.apiKey,contents:t.lint.html,environment:t.environment},on:{"lint-errors":t.onLintError,"lint-success":t.onLintSuccess,close:function(e){return t.$router.push({name:"home"})}},scopedSlots:t._u([{key:"success",fn:function(){return[n("slide-deck",{attrs:{active:t.active}},[n("div",{key:0},[n("div",{staticClass:"text-center position-relative"},[n("animate-css",{attrs:{name:"fade",up:"","leave-active-class":"position-absolute w-100 h-100"}},[t.activity||t.error?t._e():n("div",[n("img",{staticClass:"capsule-editor-modal-logo",attrs:{src:i("5f9a")}}),n("h1",{staticClass:"font-weight-light mb-4"},[t._v("Document Fixed!")]),n("h5",{staticClass:"font-weight-light mb-4 mx-5"},[t._v("Do you want to automatically send it back to us or download it and manually email it as an attachment?")]),n("div",{staticClass:"mb-5"},[n("btn",{staticClass:"mr-2",attrs:{size:"lg",variant:"success"},on:{click:t.onClickSend}},[n("icon",{attrs:{icon:"envelope"}}),t._v(" Send Now")],1),n("btn",{attrs:{size:"lg",variant:"success",outline:""},on:{click:t.onClickDownload}},[n("icon",{attrs:{icon:"download"}}),t._v(" Download")],1)],1)])]),n("animate-css",{attrs:{name:"fade",up:"","leave-active-class":"position-absolute w-100 h-100"}},[t.activity?n("div",{staticClass:"my-5 py-5"},[n("div",{staticClass:"my-5"},[n("hourglass",{attrs:{label:t.hourGlassLabel,animate:""}})],1)]):t.error?n("http-exception",{attrs:{error:t.error}},[n("div",{staticClass:"text-center"},[n("btn",{staticClass:"mr-2",attrs:{size:"lg"},on:{click:t.onClickSend}},[n("icon",{attrs:{icon:"redo"}}),t._v(" Try Again\n                                ")],1),n("btn",{attrs:{size:"lg",variant:"secondary"},on:{click:t.onClickCancel}},[n("icon",{attrs:{icon:"times-circle"}}),t._v(" Cancel\n                                ")],1)],1)]):t._e()],1)],1)]),n("div",{key:1},[n("animate-css",{attrs:{name:"fade","leave-active-class":"position-absolute w-100 h-100"}},[n("div",{staticClass:"text-center position-relative my-5"},[n("icon",{staticClass:"text-success",attrs:{icon:"check-circle",size:"6x"}}),n("h1",{staticClass:"font-weight-light mt-3 mb-0"},[t._v("Thank You!")]),n("h5",{staticClass:"font-weight-light my-4 mx-5 px-1"},[t._v("Thank you for your assistance in fixing these errors. We have received your document and will process it shortly.")]),n("btn",{attrs:{size:"lg"},on:{click:t.onClickClose}},[n("icon",{attrs:{icon:"window-close"}}),t._v(" Close Window\n                        ")],1)],1)])],1),n("div",{key:2},[n("div",{staticClass:"text-center position-relative my-5"},[n("icon",{staticClass:"text-secondary",attrs:{icon:["far","file-archive"],size:"6x"}}),n("h1",{staticClass:"font-weight-light mt-3 mb-0"},[t._v("File Downloaded!")]),n("h4",{staticClass:"font-weight-light mt-3 mb-1"},[t._v(t._s(t.download.zipname))]),n("h5",{staticClass:"font-weight-light mb-4"},[t._v("("+t._s(t.download.size)+")")]),n("div",[n("btn",{staticClass:"mr-2",attrs:{size:"lg",variant:"success"},on:{click:t.onClickDownloadAgain}},[n("icon",{attrs:{icon:"download"}}),t._v(" Download Again\n                        ")],1),n("btn",{attrs:{size:"lg"},on:{click:t.onClickClose}},[n("icon",{attrs:{icon:"window-close"}}),t._v(" Close Window\n                        ")],1)],1)],1)])])]},proxy:!0}]),model:{value:t.editor,callback:function(e){t.editor=e},expression:"editor"}})},s=[],a=i("2ef0"),o=i("6610"),r=i("5eb8"),l=i("9719"),c=i("9530"),d=i("b360"),h=i("a6f4"),u=i("566e"),m=i("ecee"),v=i("ad3d"),p=i("b702"),f=i("c074");m["c"].add(f["q"]),m["c"].add(f["g"]),m["c"].add(f["f"]),m["c"].add(f["c"]),m["c"].add(p["b"]),m["c"].add(f["r"]),m["c"].add(f["t"]);const C=Object(a["throttle"])(t=>{t&&t()},2500);var g={name:"Editor",components:{Btn:l["a"],Icon:v["a"],Hourglass:o["a"],SlideDeck:h["a"],AnimateCss:u["a"],CapsuleEditor:c["a"],HttpException:r["a"]},props:{lint:{type:Object,required:!0},team:{type:Object,required:!0},errors:Array,apiKey:{type:String,required:!0},environment:{type:String,default(){return"production"}}},data(){const t=this.errors||[];return{active:0,error:null,editor:null,revision:null,activity:!1,download:{blob:null,size:null,zipname:null,filename:null},hourGlassLabel:null,originalErrors:this.errors,currentErrors:t.slice(0),currentFilename:this.lint.filename,originalFilename:this.lint.filename,currentContents:this.lint.html||this.getSlotContents(),originalContents:this.lint.html||this.getSlotContents()}},computed:{httpRequestOptions(){return{baseURL:`http://api.thecapsule.${"production"===this.environment?"email":"test"}/v1`,headers:{Authorization:`Bearer ${this.apiKey}`}}}},watch:{editor({filename:t,contents:e}){this.currentFilename=t,this.currentContents=e}},methods:{formatBytes(t){const e=["Bytes","KB","MB","GB","TB"];if(0==t)return"0 Byte";const i=parseInt(Math.floor(Math.log(t)/Math.log(1024)));return Math.round(t/Math.pow(1024,i),2)+" "+e[i]},onClickSend(){C(()=>{this.error=null,this.activity=!0,this.hourGlassLabel="Sending...",Object(d["c"])({team_id:this.team.id,filename:this.currentFilename,revised_html:this.currentContents,original_html:this.originalContents},this.httpRequestOptions).then(t=>{C(()=>{this.active=1,this.error=null,this.activity=!1})},t=>{C(()=>{this.error=t,this.activity=!1})})})},onClickCancel(){this.error=null,this.active=0},onClickDownloadAgain(){Object(d["a"])(this.download.blob,this.download.zipname)},onClickDownload(){C(()=>{this.hourGlassLabel="Generating...",this.activity=!0,Object(d["d"])(this.currentContents,this.currentFilename).then(t=>{this.download.blob=t,this.download.filename=this.currentFilename,this.download.size=this.formatBytes(t.size),this.download.zipname=this.currentFilename.replace(/\.html/,".zip"),C(()=>{this.active=2,setTimeout(()=>{Object(d["a"])(t,this.download.zipname)},250)})})})},onClickClose(){window.close()},onLintError(t,e){this.currentErrors=e},onLintSuccess(t){this.currentErrors=[]},getSlotContents(){return this.$slots.default?this.$slots.default.filter(t=>{return"textarea"===t.tag.toLowerCase()}).reduce((t,e)=>{return t+e.children.map(t=>{return t.text}).join("")},""):null},format(t){return`Line ${t.line},${t.column} :: ${t.code} ${t.msg} (${t.rule})`}},mounted(){this.$nextTick(()=>{const{line:t,ch:e,code:i}=this.$route.query;this.$refs.editor.$refs.field.cm.state.lint.errors.forEach(n=>{n.code===i&&n.line===t&&n.ch===e&&n.focus()})})}},b=g,w=(i("f64a"),i("2877")),y=Object(w["a"])(b,n,s,!1,null,null,null);e["default"]=y.exports},9865:function(t,e,i){},f64a:function(t,e,i){"use strict";var n=i("9865"),s=i.n(n);s.a}}]);
//# sourceMappingURL=CapsuleErrorReport.umd.min.8.js.map